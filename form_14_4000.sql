declare @year int = 2022
declare @codemo int = 370024

use Elmedicine_Ivanovo

declare @formT table (rowNum nvarchar(10), ds nvarchar(100), dsFrom nvarchar(10), dsTo nvarchar(10),
	dsLike nvarchar(100), dsName nvarchar(300))
insert into @formT values
	('1', '', null, null, null, '<b>Всего операций</b>'),
	('2', '', null, null, null, 'в том числе<br><b>операции на нервной системе<br>из них:</b>'),
	('2.1', '', null, null, null, 'удаление травматической внутричерепной гематомы, очага ушиба, вдавленного перелома черепа, устранение дефекта черепа и лицевого скелета'),
	('2.2', '', null, null, null, 'операции при сосудистых пороках мозга'),
	('2.2.1', '', null, null, null, 'из них:<br>на аневризмах'),
	('2.2.1.1', '', null, null, null, 'из них эндоваскулярное выключение'),
	('2.2.2', '', null, null, null, 'на мальформациях'),
	('2.2.2.1', '', null, null, null, 'из них эндоваскулярное выключение'),
	('2.3', '', null, null, null, 'операции при церебральном инсульте'),
	('2.3.1', '', null, null, null, 'из них:<br>при геморрагическом инсульте'),
	('2.3.1.1', '', null, null, null, 'из них открытое удаление гематомы'),
	('2.3.2', '', null, null, null, 'при инфаркте мозга'),
	('2.3.2.1', '', null, null, null, 'из них: краниотомия'),
	('2.3.2.2', '', null, null, null, 'эндоваскулярная тромбоэкстрация'),
	('2.4', '', null, null, null, 'операции при окклюзионно-стенотических поражениях сосудов мозга'),
	('2.4.1', '', null, null, null, 'из них:<br>на экстрацеребральных отделах сонных и позвоночных артерий'),
	('2.4.1.1', '', null, null, null, 'из них:<br>эндартерэктомия, редрессация, реимплантация'),
	('2.4.1.2', '', null, null, null, 'стентирование'),
	('2.4.2', '', null, null, null, 'на внутричерепных артериях'),
	('2.4.2.1', '', null, null, null, 'из них: экстраинтракраниальные анастомозы'),
	('2.4.2.2', '', null, null, null, 'стентирование'),
	('2.5', '', null, null, null, 'удаление опухолей головного, спинного мозга'),
	('2.6', '', null, null, null, 'операции при функциональных расстройствах'),
	('2.6.1', '', null, null, null, 'из них:<br>при болевых синдромах'),
	('2.6.1.1', '', null, null, null, 'из них васкулярная декомпрессия'),
	('2.6.2', '', null, null, null, 'при эпилепсии, паркинсонизме, мышечно-тонических расстройствах'),
	('2.6.2.1', '', null, null, null, 'из них: резекционные и деструктивные операции'),
	('2.6.2.2', '', null, null, null, 'установка стимуляторов'),
	('2.7', '', null, null, null, 'декомпрессивные, стабилизирующие операции при позвоночно-спинальной травме'),
	('2.8', '', null, null, null, 'декомпрессивные, стабилизирующие операции при дегенеративных заболеваниях позвоночника'),
	('2.9', '', null, null, null, 'операции на периферических нервах'),
	('2.10', '', null, null, null, 'ликворошунтирующие операции'),
	('2.11', '', null, null, null, 'операции при врожденных аномалиях развития центральной нервной системы'),
	('3', '', null, null, null, '<b>операции на эндокринной системе</b>'),
	('3.1', '', null, null, null, 'из них тиреотомии'),
	('4', '', null, null, null, '<b>операции на органе зрения</b>'),
	('4.1', '', null, null, null, 'из них:<br>кератопластика'),
	('4.2', '', null, null, null, 'задняя витреоэктомия'),
	('4.3', '', null, null, null, 'транпупиллярная термотерапия'),
	('4.4', '', null, null, null, 'брахитерапия'),
	('4.5', '', null, null, null, 'операции по поводу:<br>глаукомы'),
	('4.5.1', '', null, null, null, 'из них с применением шунтов и дренажей'),
	('4.6', '', null, null, null, 'энуклеации'),
	('4.7', '', null, null, null, 'катаракты'),
	('4.7.1', '', null, null, null, 'из них методом факоэмульсификации'),
	('4.8', '', null, null, null, 'интравитреальное введение ингибитора ангиогенеза'),
	('5', '', null, null, null, '<b>операции на органах уха, горла, носа</b>'),
	('5.1', '', null, null, null, 'из них: на ухе'),
	('5.2', '', null, null, null, 'на миндалинах и аденоидах'),
	('6', '', null, null, null, '<b>операции на органах дыхания</b>'),
	('6.1', '', null, null, null, 'из них:<br>на трахее'),
	('6.2', '', null, null, null, 'пневмонэктомия'),
	('6.3', '', null, null, null, 'эксплоративная торакотомия'),
	('7', '', null, null, null, '<b>операции на сердце</b>'),
	('7.1', '', null, null, null, 'из них: на открытом сердце'),
	('7.1.2', '', null, null, null, 'из них с искусственным кровообращением'),
	('7.2', '', null, null, null, 'коррекция врожденных пороков сердца'),
	('7.2.1', '', null, null, null, 'из них: с искусственным кровообращением'),
	('7.3', '', null, null, null, 'коррекция приобретенных поражений клапанов сердца'),
	('7.3.1', '', null, null, null, 'из них: с искусственным кровообращением'),
	('7.3.2', '', null, null, null, 'эндоваскулярно'),
	('7.4', '', null, null, null, 'при нарушениях ритма – всего'),
	('7.4.1', '', null, null, null, 'из них:<br>имплантация кардиостимулятора'),
	('7.4.1.1', '', null, null, null, 'из них: трехкамерных'),
	('7.4.2', '', null, null, null, 'коррекция тахиаритмий'),
	('7.4.2.1', '', null, null, null, 'из них катетерных аблаций'),
	('7.4.3', '', null, null, null, 'имплантированных кардиовертеров-дефибриляторов (ИКД)'),
	('7.4.3.1', '', null, null, null, 'из них: трехкамерных ИКД'),
	('7.5', '', null, null, null, 'по поводу ишемических болезней сердца'),
	('7.5.1', '', null, null, null, 'из них:<br>аортокоронарное шунтирование'),
	('7.5.1.1', '', null, null, null, 'из них: с искусственным кровообращением'),
	('7.5.1.2', '', null, null, null, 'малоинвазивная реваскуляризация миокарда (МИРМ)'),
	('7.5.2', '', null, null, null, 'ангиопластика коронарных артерий'),
	('7.5.2.1', '', null, null, null, 'из них со стентированием'),
	('8', '', null, null, null, '<b>операции на сосудах</b>'),
	('8.1', '', null, null, null, 'из них:<br>операции на артериях'),
	('8.1.1', '', null, null, null, 'из них: на питающих головной мозг'),
	('8.1.1.1', '', null, null, null, 'из них:<br>каротидные эндартерэктомии'),
	('8.1.1.2', '', null, null, null, 'экстраинтракраниальные анастомозы'),
	('8.1.1.3', '', null, null, null, 'рентгенэндоваскулярные дилятации'),
	('8.1.1.3.1', '', null, null, null, 'из них со стентированием'),
	('8.1.2', '', null, null, null, 'на почечных артериях'),
	('8.1.3', '', null, null, null, 'на аорте'),
	('8.1.3.1', '', null, null, null, 'из них: при аневризмах и расслоениях восходящего отдела аорты'),
	('8.2', '', null, null, null, 'операции на венах'),
	('9', '', null, null, null, '<b>операции на органах брюшной полости</b>'),
	('9.1', '', null, null, null, 'из них:<br>на желудке по поводу язвенной болезни'),
	('9.2', '', null, null, null, 'аппендэктомии при хроническом аппендиците'),
	('9.3', '', null, null, null, 'грыжесечение при неущемленной грыже'),
	('9.4', '', null, null, null, 'холецистэктомия при хроническом холецистите'),
	('9.5', '', null, null, null, 'лапаротомия диагностическая'),
	('9.6', '', null, null, null, 'на кишечнике'),
	('9.6.1', '', null, null, null, 'из них на прямой кишке'),
	('9.7', '', null, null, null, 'по поводу геморроя'),
	('10', '', null, null, null, '<b>операции на почках и мочеточниках</b>'),
	('11', '', null, null, null, '<b>операции на мужских половых органах</b>'),
	('11.1', '', null, null, null, 'из них операции на предстательной железе'),
	('12', '', null, null, null, '<b>операции по поводу стерилизации мужчин</b>'),
	('13', '', null, null, null, '<b>операции на женских половых органах</b>'),
	('13.1', '', null, null, null, 'из них:<br>экстирпация и надвлагалищная ампутация матки'),
	('13.2', '', null, null, null, 'на придатках матки по поводу бесплодия'),
	('13.3', '', null, null, null, 'на яичниках по поводу новообразований'),
	('13.4', '', null, null, null, 'по поводу стерилизации женщин'),
	('13.5', '', null, null, null, 'выскабливание матки (кроме аборта)'),
	('14', '', null, null, null, '<b>акушерские операции</b>'),
	('14.1', '', null, null, null, 'из них:<br>по поводу внематочной беременности'),
	('14.2', '', null, null, null, 'наложение щипцов'),
	('14.3', '', null, null, null, 'вакуум-экстракция'),
	('14.4', '', null, null, null, 'кесарево сечение в сроке 22 недель беременности и более'),
	('14.5', '', null, null, null, 'кесарево сечение в сроке менее 22 недель беременности'),
	('14.6', '', null, null, null, 'аборт'),
	('14.7', '', null, null, null, 'плодоразрушающие'),
	('14.8', '', null, null, null, 'экстирпация и надвлагалищная ампутация матки в сроке 22 недель беременности и более, в родах и после родов'),
	('14.9', '', null, null, null, 'экстирпация и надвлагалищная ампутация матки при прерывании беременности в сроке менее 22 недель беременности или после прерывания'),
	('15', '', null, null, null, '<b>операции на костно-мышечной системе</b>'),
	('15.1', '', null, null, null, 'из них:<br>корригирующие остеотомии'),
	('15.2', '', null, null, null, 'на челюстно-лицевой области'),
	('15.3', '', null, null, null, 'при травмах костей таза'),
	('15.4', '', null, null, null, 'при около- и внутрисуставных переломах'),
	('15.5', '', null, null, null, 'на позвоночнике'),
	('15.6', '', null, null, null, 'при врожденном вывихе бедра'),
	('15.7', '', null, null, null, 'ампутации и экзартикуляции'),
	('15.8', '', null, null, null, 'эндопротезирование, всего'),
	('15.8.1', '', null, null, null, 'из него:<br>тазобедренного сустава'),
	('15.8.2', '', null, null, null, 'коленного сустава'),
	('15.9', '', null, null, null, 'на грудной стенке'),
	('15.9.1', '', null, null, null, 'из них:<br>торакомиопластика'),
	('15.9.2', '', null, null, null, 'торакостомия'),
	('16', '', null, null, null, '<b>операции на молочной железе</b>'),
	('17', '', null, null, null, '<b>операции на коже и подкожной клетчатке</b>'),
	('17.1', '', null, null, null, 'из них операции на челюстно-лицевой области'),
	('18', '', null, null, null, '<b>операции на средостении</b>'),
	('18.1', '', null, null, null, 'из них операции на вилочковой железе'),
	('19', '', null, null, null, '<b>операции на пищеводе</b>'),
	('20', '', null, null, null, '<b>операции на лимфатической системе</b>'),
	('21', '', null, null, null, '<b>прочие операции</b>')

select dsName, rowNum, ds
from @formT	--left join @sampleT on DS1 between dsFrom and dsTo or DS1 like dsLike
group by dsName, rowNum, ds
order by cast('/'+replace(rowNum,'.','/')+'/' as hierarchyid)